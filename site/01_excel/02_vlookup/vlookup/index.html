<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Norm Jones" /><link rel="canonical" href="https://vbaprimer.readthedocs.io/en/latest/01_excel/02_vlookup/vlookup/" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>VLOOKUP - Excel VBA Primer</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../../css/custom.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "VLOOKUP";
        var mkdocs_page_input_path = "01_excel/02_vlookup/vlookup.md";
        var mkdocs_page_url = "/en/latest/01_excel/02_vlookup/vlookup/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/bash.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/excel.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/vbnet.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/vba.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../.." class="icon icon-home"> Excel VBA Primer
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Excel Fundamentals</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../../01_formulas/formulas/">Formulas</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">VLOOKUP</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#data-validation">Data Validation</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#vlookup-function">VLOOKUP Function</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#range-lookups">Range Lookups</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#two-dimensional-lookup">Two-Dimensional Lookup</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#sample-workbooks">Sample Workbooks</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#exercises">Exercises</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../03_validation/validation/">Validation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../04_names/names/">Names</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../05_operators/operators/">Operators</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../06_iffunction/iffunction/">IF Function</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../07_goalseek/goalseek/">Goal Seek</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../08_charts/charts/">Charts</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../09_annotation/annotation/">Annotation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../10_arrayform/arrayform/">Array Formulas</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Excel VBA</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../02_vba/01_gettingstarted/gettingstarted/">Getting Started</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../02_vba/02_macros/macros/">Macros</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../02_vba/03_controls/controls/">Controls</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../02_vba/04_ranges/ranges/">Ranges</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../02_vba/05_msgbox/msgbox/">MsgBox</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../02_vba/06_variables/variables/">Variables</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../02_vba/07_objects/objects/">Objects</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../02_vba/08_ifthen/ifthen/">If Statements</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../02_vba/09_debug/debug/">Debugging</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../02_vba/10_loops/loops/">Loops</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../02_vba/11_arrays/arrays/">Arrays</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../02_vba/12_strings/strings/">Strings</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../02_vba/13_userforms/userforms/">User Forms</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../02_vba/14_functions/functions/">Functions</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../02_vba/15_excelfunctions/excelfunctions/">Excel Functions</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../02_vba/16_subs/subs/">Subs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../02_vba/17_events/events/">Events</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../02_vba/18_standards/standards/">Standards</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Advanced Topics</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../03_advanced/01_graphics/graphics/">Graphics</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../03_advanced/02_email/email/">Email</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../03_advanced/03_files/files/">Files</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../03_advanced/04_apps/apps/">Sample Apps</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../03_advanced/05_gas/gas/">Google App Script</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">Excel VBA Primer</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Excel Fundamentals</li>
      <li class="breadcrumb-item active">VLOOKUP</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/njones61/vbaprimer/edit/master/docs/01_excel/02_vlookup/vlookup.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="indexing-a-list-with-vlookup">Indexing a List with VLOOKUP</h1>
<p>When writing formulas, we often encounter cases where one or more of the inputs to the function will depend on the value of another input. More specifically, we need to use one of the inputs to lookup the other input from a table. This can be easily accomplished using the VLOOKUP function.</p>
<p>For example, the following workbook computes the volume and weight of a set of cylinders. The weight is computing from the volume and the unit weight. However, the unit weight depends on the material being used. Unit weights for a set of common materials are shown in a table at the top:</p>
<p><img alt="start.png" src="../images/start.png" /></p>
<p>The objective of this exercise is to determine the appropriate unit weight for each cylinder and calculate the correct weight by multiplying the selected unit weight by the computed volume. We will do this by automatically selecting the correct unit weight from the list using the VLOOKUP function.</p>
<h2 id="data-validation">Data Validation</h2>
<p>Before using the VLOOKUP function, we need to enter a set of materials in the Material column. We need to be careful as we do this because due to the way the VLOOKUP function works, we need to ensure that the items in the Materials column are spelled exactly the same way they are spelled in the unit weight table at the top. We can do this with a tool called Data Validation. This process is described in the Data Validation chapter.</p>
<h2 id="vlookup-function">VLOOKUP Function</h2>
<p>Once the material values are entered in column E, we are ready to use the VLOOKUP function. The syntax for the VLOOKUP function is as follows:</p>
<pre><code>=VLOOKUP(lookup_value,table_array,col_index_num,range_lookup)
</code></pre>
<p>where:</p>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>lookup_value</code></td>
<td>The value to be found in the first column of the array</td>
</tr>
<tr>
<td><code>table_array</code></td>
<td>The table of information in which data is looked up. Use a reference to a range or a range name</td>
</tr>
<tr>
<td><code>col_index_num</code></td>
<td>The column number in table_array from which the matching value must be returned</td>
</tr>
<tr>
<td><code>range_lookup</code></td>
<td>A logical value (TRUE or FALSE) that specifies whether you want VLOOKUP to find an exact match or an approximate match.</td>
</tr>
</tbody>
</table>
<p>So for our case, we will use VLOOKUP to select a unit weight value from the table using the user-specified material. The unit weight returned by the function is then multiplied by the volume to compute the cylinder weight as follows:</p>
<p><img alt="vlookup-1.png" src="../images/vlookup-1.png" /></p>
<p>The first argument (E13) to the VLOOKUP function refers to the Material value on the same row and is a relative reference. The second argument (<span class="arithmatex">\(B\)</span>5:<span class="arithmatex">\(C\)</span>10) is an absolute reference to the table use for the lookup. The lookup value ("Concrete" in this case) is used to search through the first column in the table to find the row matching the lookup value. In this case, the match is found on the third row of the table (cell B7). The third argument ("2") tells the VLOOKUP function from which column of the table the return value should be selected. Since the value is 2, we go to the second column of the lookup table on the selected row and find our value ("150"). This is the value that is returned by the function and multiplied by the volume ("1.6") to compute the weight. After copying this formula to the rest of the column, the weight values are all correctly computed as follows:</p>
<p><img alt="vlookup-1b.png" src="../images/vlookup-1b.png" /></p>
<p>If the values in the lookup table are edited, all of the weights would be automatically updated.</p>
<h2 id="range-lookups">Range Lookups</h2>
<p>In the example shown in the previous section, we are doing an exact match on the lookup value in the first column. In some cases we are not looking for an exact match, but we need to find a match from a set of numerical ranges. For example, suppose that we wanted to categorize the cylinder weights using the following guidelines:</p>
<table>
<thead>
<tr>
<th>Weight (wt)</th>
<th>Category</th>
</tr>
</thead>
<tbody>
<tr>
<td>wt ≤ 1000</td>
<td>Ultra Light</td>
</tr>
<tr>
<td>1000 ≤ wt ≤ 2000</td>
<td>Light</td>
</tr>
<tr>
<td>2000 ≤ wt ≤ 10,000</td>
<td>Medium</td>
</tr>
<tr>
<td>10,000 ≤ wt ≤ 100,000</td>
<td>Heavy</td>
</tr>
<tr>
<td>100,000 ≤ wt</td>
<td>Extra Heavy</td>
</tr>
</tbody>
</table>
<p>We will then add a new table and an extra column as follows:</p>
<p><img alt="rangelookup-1.png" src="../images/rangelookup-1.png" /></p>
<p>Note that the weight values in the first column of the weight-category table at the top right has been sorted in ascending order. This is critical in order for the lookup to work. Next, we enter a formula using the VLOOKUP function as follows:</p>
<p><img alt="rangelookup-2.png" src="../images/rangelookup-2.png" /></p>
<p>Notice that the last argument (range_lookup) has a value of TRUE. This means that we take the lookup_value ("235.6" in this case) and we look through the first column of the table until we find a row where the value on the row is less than or equal to the lookup_value and the value on the next row is greater than the lookup_value. In this case, the match occurs on the first row and so the resulting value from column 2 is "Ultra Light". After copying the formula to the rest of the Category column, the resulting values are as follows:</p>
<p><img alt="rangelookup-3.png" src="../images/rangelookup-3.png" /></p>
<p>It is important to note that the range_lookup argument to the VLOOKUP function is optional. If it is omitted, it is assumed to be TRUE by default. A common error with the VLOOKUP function is to omit this argument when the VLOOKUP function is intended to be used as an exact match. This can lead to unintended errors, depending on how the values in the first column are ordered. Therefore, it is strongly recommended to always enter a TRUE or FALSE value for the range_lookup argument every time the VLOOKUP function is used.</p>
<h2 id="two-dimensional-lookup">Two-Dimensional Lookup</h2>
<p>Occasionally it is useful to do a two-dimensional lookup where a value is found from a table containing both rows and columns. For example, consider the following sheet containing a table of temperatures in degree F illustrating a relationship between average monthly temp and elevation in ft for a particular location.</p>
<p><img alt="tempelev.png" src="../images/tempelev.png" /></p>
<p>Starting at row 24, another table is listed and the objective is to fill in the Temp column with a formula that looks up the temp corresponding to the elevation from column C and the month associated with the date provided in column B. This requires a double lookup. We use VLOOKUP to find the row we need based on a range lookup of elevation using the VLOOKUP function. Then, for the third argument to VLOOKUP, we need to determine which column to use based on the month desired. To find the right column based on the month, we first need to find the month label ("Jan", "Feb", etc.) from a date value. This can be accomplished using the TEXT function which takes a date as an argument and returns the month or day value depending on the format specified by the second argument as follows:</p>
<pre><code>=TEXT(B24,&quot;MMM&quot;)
</code></pre>
<p>For the values shown, the function would return "Mar". Then we need to use this text string to automatically find the index of the column corresponding to this month. This can be done with the MATCH function as follows:</p>
<pre><code>=MATCH(TEXT(B24,&quot;MMM&quot;),$C$5:$N$5,0)
</code></pre>
<p>The first argument to the MATCH funciton is the lookup value, the second argument is an array (row or column of values) and the third argument indicates the type of match to perform (a value of 0 tells it to find an exact match). The function looks through the array to find the lookup value and returns the index of the item if found. For the arguments shown, the function would return a value of 3. At this point, we are ready to use the VLOOKUP function. We would formulate the function call as follows:</p>
<p><img alt="tempelev2.png" src="../images/tempelev2.png" /></p>
<p>Note that we are using a range lookup on elevation so the last argument to VLOOKUP is TRUE.</p>
<h2 id="sample-workbooks">Sample Workbooks</h2>
<p>The workbooks used in the examples shown above can be downloaded here:</p>
<p><a href="../files/cylinders2.xlsx">cylinders2.xlsx</a> <a href="../files/tempvselev.xlsx">tempvselev.xlsx</a></p>
<h2 id="exercises">Exercises</h2>
<p>You may wish to complete following exercises to gain practice with and reinforce the topics covered in this chapter:</p>
<div class="exercise-grid" data-columns="4">
<div class="exercise-header">Description</div>
<div class="exercise-header">Difficulty</div>
<div class="exercise-header">Start</div>
<div class="exercise-header">Solution</div>
<div class="exercise-cell">Use VLOOKUP to match the number of human years to the appropriate dog years shown in the table.</div>
<div class="exercise-cell">Easy</div>
<div class="exercise-cell"><a href="files/dog_years.xlsx">dog_years.xlsx</a></div>
<div class="exercise-cell"><a href="files/dog_years_key.xlsx">dog_years_key.xlsx</a></div>
<div class="exercise-cell">From a list of fencing materials, match the price using VLOOKUP and the table given. Thenx multiply by the amount of yards needed to obtain the total cost.</div>
<div class="exercise-cell">Easy</div>
<div class="exercise-cell"><a href="files/construction_fencing.xlsm">construction_fencing.xlsm</a></div>
<div class="exercise-cell"><a href="files/construction_fencing_key.xlsm">construction_fencing_key.xlsm</a></div>
<div class="exercise-cell">Use VLOOKUP to multiply the user input by the appropriate conversion factor desired.</div>
<div class="exercise-cell">Medium</div>
<div class="exercise-cell"><a href="files/conversion_factor.xlsm">conversion_factor.xlsm</a></div>
<div class="exercise-cell"><a href="files/conversion_factor_key.xlsm">conversion_factor_key.xlsm</a></div>
<div class="exercise-cell">From a list of foods and servings, use VLOOKUP to calculate the number of calories and carbs.</div>
<div class="exercise-cell">Hard</div>
<div class="exercise-cell"><a href="files/diet_monitor.xlsx">diet_monitor.xlsx</a></div>
<div class="exercise-cell"><a href="files/diet_monitor_key.xlsx">diet_monitor_key.xlsx</a></div>
</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../../01_formulas/formulas/" class="btn btn-neutral float-left" title="Formulas"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../../03_validation/validation/" class="btn btn-neutral float-right" title="Validation">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/njones61/vbaprimer" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../../01_formulas/formulas/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../../03_validation/validation/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../..";</script>
    <script src="../../../js/theme_extra.js"></script>
    <script src="../../../js/theme.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.js"></script>
      <script src="../../../js/mathjax-config.js"></script>
      <script src="../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
